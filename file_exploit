import webbrowser

postdata = {'attachments': [{'contentType': 'application/vnd.microsoft.teams.file.download.info',
                             'content': {
                                 'downloadUrl': 'https://abachem479-my.sharepoint.com/personal/admin_abachem479_onmicrosoft_com/_layouts/15/download.aspx?UniqueId=4a35ec3a-1ab8-4455-9dd1-273c',
                                 'uniqueId': '4a35ec3a-1ab8-4455-9dd1-273c1229014c', 'fileType': 'txt'},
                             'contentUrl': 'https://abachem479-my.sharepoint.com/personal/admin_abachem479_onmicrosoft_com/Documents/Microsoft Teams Chat Files/commands.txt',
                             'name': 'commands.txt'}],
            'from': {'id': '29:1mhe1WmNnSJ5Xn1CyJj3tOOpB4bP-YyyH2Qt8hBcg90Mxmsa_8gAxh56tN-mWhlq7IN1EeWBF8bT5-qXNO4fJig',
                     'name': 'sidharth sridhar', 'aadObjectId': '7bd287c0 - 5650 - 49de - ba51 - 028f4779e1e1'}
            }

if 'attachments' in postdata:
    attachmentlist = postdata['attachments']
    Fdict = attachmentlist[0]
    if Fdict['contentType'] == 'application/vnd.microsoft.teams.file.download.info':
        print(Fdict['contentUrl'])
        print(postdata['from']['id'])
        x = postdata['from']['id']
        x = x.replace(":", "")
        print(x)
        fname = "C:\\Users\Admin\\rasafilehandler\\" + x + ".txt"
        print(fname)
        tempfile = open(fname, "w+")
        tempfile.write(Fdict['contentUrl'])
        tempfile.close()
        webbrowser.open(Fdict['contentUrl'])
        postdata.pop('attachments')
        postdata['text'] = "Files are uploaded"
        print(postdata)
